<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Story Jadwal Cuti Dokter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; }
        #story-preview {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(160deg, #192670, #4c9b32);
            color: white;
            width: 1080px;
            height: 1920px;
            position: relative;
            overflow: hidden;
        }
        .montserrat { font-family: 'Montserrat', sans-serif; }
        #story-preview img { object-fit: cover; }
        #story-preview .flex .items-center img.rounded-full { object-position: center 25%; }
        #dot-pattern-overlay {
            background-image: radial-gradient(circle, #000080 1px, transparent 1px);
            background-size: 15px 15px;
            opacity: 0.05;
            z-index: 0;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div id="story-preview" class="flex flex-col p-16">
        <div id="dot-pattern-overlay" class="absolute inset-0 hidden"></div>
        <div class="flex-shrink-0 flex justify-center items-center relative z-10">
            <img id="story-logo" src="" class="h-28" alt="Logo">
        </div>
        <div class="flex-grow flex flex-col justify-start items-center text-center pt-20 relative z-10">
            <div class="mb-12">
                <p class="text-5xl tracking-widest montserrat">PEMBERITAHUAN</p>
                <h2 class="text-9xl font-extrabold mt-2 montserrat">JADWAL CUTI</h2>
            </div>
            <div id="story-doctors-list" class="w-full flex flex-col items-center justify-center flex-grow space-y-8 px-12 relative z-10">
                </div>
        </div>
        <div class="flex-shrink-0 text-center relative z-10">
            <p class="text-3xl font-semibold">Informasi lebih lanjut, hubungi kami.</p>
        </div>
    </div>

<script>
    // File ini sekarang hanya berisi fungsi rendering, TIDAK ADA LOGIKA FETCH DATA
    let combinedData = [];

    function updateBackground(theme) {
        const storyPreview = document.getElementById('story-preview');
        const dotPatternOverlay = document.getElementById('dot-pattern-overlay');
        storyPreview.style.background = '';
        storyPreview.style.color = 'white';
        dotPatternOverlay.classList.add('hidden');
        switch(theme) {
            case 'gradient-purple': storyPreview.style.background = 'linear-gradient(160deg, #5a189a, #c1121f, #f77f00)'; break;
            case 'gradient-orange': storyPreview.style.background = 'linear-gradient(160deg, #f7b267, #f79d65, #f4845f)'; break;
            case 'solid-white': 
                storyPreview.style.background = 'white'; 
                storyPreview.style.color = '#374151'; 
                dotPatternOverlay.classList.remove('hidden');
                break;
            default: storyPreview.style.background = 'linear-gradient(160deg, #192670, #4c9b32)'; break;
        }
    }

    function updateStoryPreview(doctorIds) {
        const doctorsListContainer = document.getElementById('story-doctors-list');
        if (!doctorIds || doctorIds.length === 0) return;

        const selectedDoctorsData = doctorIds.map(id => combinedData.find(d => d.id === id)).filter(Boolean);
        let doctorHTML = '';
        const numDoctors = selectedDoctorsData.length;
        
        let containerClass = "w-full flex flex-col items-center justify-center flex-grow space-y-8 px-12";
        let itemClass = "flex items-center w-full bg-white/20 rounded-3xl p-8 shadow-lg";
        let photoClass = "w-48 h-48 rounded-full object-cover border-8 border-white flex-shrink-0";
        let textContainerClass = "ml-8 text-left";
        let nameClass = "text-5xl font-bold";
        let specialtyClass = "text-3xl opacity-90 mt-1";
        let dateClass = "text-3xl mt-4";

        if (numDoctors > 2) {
            containerClass = "w-full flex flex-col items-center justify-center flex-grow space-y-6 px-10";
            itemClass = "flex items-center w-full bg-white/20 rounded-3xl p-6 shadow-lg";
            photoClass = "w-40 h-40 rounded-full object-cover border-8 border-white flex-shrink-0";
            textContainerClass = "ml-6 text-left";
            nameClass = "text-4xl font-bold";
            specialtyClass = "text-2xl opacity-90 mt-1";
            dateClass = "text-2xl mt-3";
        }
        if (numDoctors > 4) {
            containerClass = "w-full flex flex-col items-center justify-center flex-grow space-y-4 px-8";
            itemClass = "flex items-center w-full bg-white/20 rounded-2xl p-4 shadow-lg";
            photoClass = "w-32 h-32 rounded-full object-cover border-4 border-white flex-shrink-0";
            textContainerClass = "ml-4 text-left";
            nameClass = "text-3xl font-bold";
            specialtyClass = "text-xl opacity-90";
            dateClass = "text-xl mt-2";
        }

        doctorsListContainer.className = containerClass;
        
        function formatFullDate(dateStr) {
            if (!dateStr) return '';
            const parts = dateStr.split('-');
            if (parts.length !== 3) return dateStr;
            const day = parseInt(parts[0], 10);
            const month = parseInt(parts[1], 10) - 1;
            const year = parseInt(parts[2], 10);
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Ags', 'Sep', 'Okt', 'Nov', 'Des'];
            return `${day} ${months[month]} ${year}`;
        }

        selectedDoctorsData.forEach(doctor => {
            const startDate = formatFullDate(doctor.cutiMulai);
            const endDate = formatFullDate(doctor.cutiSelesai);
            const leaveDatesText = (startDate === endDate) ? startDate : `${startDate} - ${endDate}`;
            doctorHTML += `
                <div class="${itemClass}">
                    <img src="${doctor.fotourl}" class="${photoClass}" alt="Foto ${doctor.nama}" onerror="this.src='https://placehold.co/200x200/ffffff/cccccc?text=Error'">
                    <div class="${textContainerClass}">
                        <h3 class="${nameClass}">${doctor.nama}</h3>
                        <p class="${specialtyClass}">${doctor.spesialis}</p>
                        <p class="${dateClass}">Tidak praktek: <strong class="font-semibold">${leaveDatesText}</strong></p>
                    </div>
                </div>`;
        });
        doctorsListContainer.innerHTML = doctorHTML;
    }
</script>
</body>
</html>