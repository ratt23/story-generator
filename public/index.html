<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Story Cuti Dokter - Kumpulan Tools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; }
        #story-preview {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(160deg, #192670, #4c9b32);
            color: white;
            width: 1080px; height: 1920px;
            transform-origin: center;
            position: relative; overflow: hidden;
            transition: transform 0.2s ease-in-out, background 0.3s, color 0.3s;
        }
        .montserrat { font-family: 'Montserrat', sans-serif; }
        #doctor-checkbox-list::-webkit-scrollbar { width: 8px; }
        #doctor-checkbox-list::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        #doctor-checkbox-list::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        #doctor-checkbox-list::-webkit-scrollbar-thumb:hover { background: #555; }
        #story-preview img { object-fit: cover; }
        #story-preview .flex .items-center img.rounded-full { object-position: center 10%; }
    </style>
</head>
<body class="bg-slate-100 h-screen flex flex-col">

    <nav class="bg-white shadow-md w-full flex-shrink-0">
        <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
            <div class="flex h-16 items-center justify-between">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <span class="font-bold text-xl text-slate-800">Kumpulan Tools</span>
                    </div>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#" class="bg-blue-600 text-white rounded-md px-3 py-2 text-sm font-medium" aria-current="page">Design Story Cuti Dokter</a>
                        <a href="#" class="text-slate-500 hover:bg-slate-100 hover:text-slate-900 rounded-md px-3 py-2 text-sm font-medium">Brochure Cuti Dokter</a>
                        <a href="#" class="text-slate-500 hover:bg-slate-100 hover:text-slate-900 rounded-md px-3 py-2 text-sm font-medium">Public Holiday Operational</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <main class="flex-grow flex flex-col md:flex-row md:overflow-hidden">
        <div class="w-full md:w-1/3 lg:w-1/4 bg-white p-6 shadow-lg md:overflow-y-auto flex-shrink-0 border-b md:border-b-0 md:border-r border-slate-200">
            <div class="mb-6">
                <h1 class="text-2xl font-bold text-slate-800">Desain Story Cuti</h1>
                <p class="text-slate-500">Gunakan panel ini untuk membuat gambar jadwal cuti.</p>
            </div>
            
            <div id="loading-state" class="text-center py-8">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"></div>
                <p class="mt-4 text-slate-600">Memuat data dari Google Sheets...</p>
            </div>

            <div id="controls" class="hidden space-y-6">
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Pilih Dokter Cuti</label>
                    <div id="doctor-checkbox-list" class="w-full p-3 border border-slate-300 rounded-lg max-h-60 overflow-y-auto space-y-2"></div>
                </div>
                <div>
                    <label for="logo-url" class="block text-sm font-medium text-slate-700 mb-1">URL Logo (Opsional)</label>
                    <input type="text" id="logo-url" placeholder="Biarkan kosong untuk logo default" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label for="background-select" class="block text-sm font-medium text-slate-700 mb-1">Pilih Tema Background</label>
                    <select id="background-select" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                        <option value="gradient-blue" selected>Biru & Hijau (Default)</option>
                        <option value="gradient-purple">Ungu & Pink</option>
                        <option value="gradient-orange">Oranye & Kuning</option>
                        <option value="solid-white">Putih Polos</option>
                        <option value="solid-white-dots">Putih Solid dengan Dots</option>
                    </select>
                </div>
                <div class="pt-4">
                    <button id="download-button" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed transition-colors">
                        <span id="button-text">Pilih Dokter Dahulu</span>
                    </button>
                </div>
            </div>
            <div id="error-state" class="hidden text-center py-8 bg-red-50 border-l-4 border-red-400 p-4">
                <p class="font-bold text-red-800">Gagal Memuat Data</p>
                <p class="text-sm text-red-600">Coba muat ulang halaman atau periksa koneksi internet.</p>
            </div>
        </div>

        <div class="flex-grow bg-slate-100 flex items-center justify-center py-10 md:p-4">
            <div id="preview-container" class="w-full h-full flex items-center justify-center">
                <div id="story-preview" class="flex flex-col p-16 shadow-2xl">
                    <div class="flex-shrink-0 flex justify-center items-center relative z-10">
                        <img id="story-logo" src="asset/logo/logo.png" class="h-28" alt="Logo">
                    </div>
                    <div class="flex-grow flex flex-col justify-start items-center text-center pt-20 relative z-10">
                        <div class="mb-12">
                            <p class="text-5xl tracking-widest montserrat">PEMBERITAHUAN</p>
                            <h2 class="text-9xl font-extrabold mt-2 montserrat">DOKTER CUTI</h2>
                        </div>
                        <div id="story-doctors-list" class="w-full flex flex-col items-center justify-center flex-grow space-y-6 px-12 relative z-10"></div>
                    </div>
                    <div class="flex-shrink-0 text-center relative z-10">
                        <p class="text-3xl font-semibold">Siloam Hospitals Ambon</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const GOOGLE_SCRIPT_JADWAL_URL = 'https://script.google.com/macros/s/AKfycbw6Fz5vI992Xya34JAkwMRY4oD1opCoBiWTQpPoTNSe9F_b5IdbI-ydtNix2AOj0IgyDg/exec';
    const GOOGLE_SCRIPT_CUTI_URL = 'https://script.google.com/macros/s/AKfycbxEp7OwCT0M9Zak1XYeSu4rjkQTjoD-qgh8INEW5btIVVNv15i1DnzI3RUwmLoqG9TtSQ/exec';
    const LOCAL_WEBP_IMAGE_PATH = 'asset/webp/';
    const controls = document.getElementById('controls');
    const loadingState = document.getElementById('loading-state');
    const doctorCheckboxList = document.getElementById('doctor-checkbox-list');
    const downloadButton = document.getElementById('download-button');
    const buttonText = document.getElementById('button-text');
    const backgroundSelect = document.getElementById('background-select');
    const storyLogo = document.getElementById('story-logo');
    let allCutiData = [];

    function createDoctorSlug(doctorName) {
        if (!doctorName) return '';
        return doctorName
            .toLowerCase()
            .replace(/\b(dr|drg)\b\.?\s*/gi, '')
            .replace(/\bsp\.[a-z]+\b/gi, '')
            .replace(/\bm\.[a-z]+\b/gi, '')
            .replace(/\bsubsp\.[a-z]+\b/gi, '')
            .replace(/\b[a-z]{2,}\b/gi, '')
            .replace(/[.,()]/g, '')
            .trim()
            .replace(/\s+/g, '-');
    }

    // ... kode lain tetap sama (tidak berubah) ...
});
</script>
</body>
</html>
